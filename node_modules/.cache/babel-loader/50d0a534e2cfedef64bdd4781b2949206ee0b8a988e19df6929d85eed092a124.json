{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\jose_\\\\Desktop\\\\Corso pc\\\\Corso\\\\Pratica\\\\Progetto Finale\\\\frontend\\\\src\\\\context\\\\CartContext.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport { createContext, useContext, useState, useEffect } from 'react';\nimport { useAuth } from './AuthContext';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst CartContext = /*#__PURE__*/createContext();\nexport const CartProvider = ({\n  children\n}) => {\n  _s();\n  const {\n    user\n  } = useAuth();\n  const [cart, setCart] = useState([]);\n\n  // Carica carrello dal localStorage al login\n  useEffect(() => {\n    if (user !== null && user !== void 0 && user.id) {\n      const storedCart = localStorage.getItem(`cart_${user.id}`);\n      setCart(storedCart ? JSON.parse(storedCart) : []);\n    } else {\n      setCart([]);\n    }\n  }, [user]);\n\n  // Salva carrello nel localStorage quando cambia\n  useEffect(() => {\n    if (user !== null && user !== void 0 && user.id) {\n      localStorage.setItem(`cart_${user.id}`, JSON.stringify(cart));\n    }\n  }, [cart, user]);\n  const addToCart = game => {\n    setCart(prev => {\n      const existing = prev.find(g => g._id === game._id);\n      const stock = typeof game.stock === 'number' ? game.stock : parseInt(game.stock, 10) || 0;\n      if (stock <= 0) {\n        alert(`\"${game.title}\" non è attualmente disponibile.`);\n        return prev;\n      }\n      if (existing) {\n        if (existing.quantity >= stock) {\n          alert(`Hai già aggiunto tutte le copie disponibili di \"${game.title}\".`);\n          return prev;\n        }\n        return prev.map(g => g._id === game._id ? {\n          ...g,\n          quantity: g.quantity + 1\n        } : g);\n      } else {\n        return [...prev, {\n          ...game,\n          quantity: 1\n        }];\n      }\n    });\n  };\n  const removeFromCart = id => {\n    setCart(prev => prev.filter(game => game._id !== id));\n  };\n  const clearCart = () => setCart([]);\n  return /*#__PURE__*/_jsxDEV(CartContext.Provider, {\n    value: {\n      cart,\n      addToCart,\n      removeFromCart,\n      clearCart\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 63,\n    columnNumber: 5\n  }, this);\n};\n_s(CartProvider, \"14d/OQbZaOw9YETcZe6/LOSkMwA=\", false, function () {\n  return [useAuth];\n});\n_c = CartProvider;\nexport const useCart = () => {\n  _s2();\n  return useContext(CartContext);\n};\n_s2(useCart, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\nvar _c;\n$RefreshReg$(_c, \"CartProvider\");","map":{"version":3,"names":["createContext","useContext","useState","useEffect","useAuth","jsxDEV","_jsxDEV","CartContext","CartProvider","children","_s","user","cart","setCart","id","storedCart","localStorage","getItem","JSON","parse","setItem","stringify","addToCart","game","prev","existing","find","g","_id","stock","parseInt","alert","title","quantity","map","removeFromCart","filter","clearCart","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","useCart","_s2","$RefreshReg$"],"sources":["C:/Users/jose_/Desktop/Corso pc/Corso/Pratica/Progetto Finale/frontend/src/context/CartContext.js"],"sourcesContent":["import { createContext, useContext, useState, useEffect } from 'react';\r\nimport { useAuth } from './AuthContext';\r\n\r\nconst CartContext = createContext();\r\n\r\nexport const CartProvider = ({ children }) => {\r\n  const { user } = useAuth();\r\n  const [cart, setCart] = useState([]);\r\n\r\n  // Carica carrello dal localStorage al login\r\n  useEffect(() => {\r\n    if (user?.id) {\r\n      const storedCart = localStorage.getItem(`cart_${user.id}`);\r\n      setCart(storedCart ? JSON.parse(storedCart) : []);\r\n    } else {\r\n      setCart([]);\r\n    }\r\n  }, [user]);\r\n\r\n  // Salva carrello nel localStorage quando cambia\r\n  useEffect(() => {\r\n    if (user?.id) {\r\n      localStorage.setItem(`cart_${user.id}`, JSON.stringify(cart));\r\n    }\r\n  }, [cart, user]);\r\n\r\n  const addToCart = (game) => {\r\n    setCart(prev => {\r\n      const existing = prev.find(g => g._id === game._id);\r\n\r\n      const stock = typeof game.stock === 'number'\r\n        ? game.stock\r\n        : parseInt(game.stock, 10) || 0;\r\n\r\n      if (stock <= 0) {\r\n        alert(`\"${game.title}\" non è attualmente disponibile.`);\r\n        return prev;\r\n      }\r\n\r\n      if (existing) {\r\n        if (existing.quantity >= stock) {\r\n          alert(`Hai già aggiunto tutte le copie disponibili di \"${game.title}\".`);\r\n          return prev;\r\n        }\r\n        return prev.map(g =>\r\n          g._id === game._id\r\n            ? { ...g, quantity: g.quantity + 1 }\r\n            : g\r\n        );\r\n      } else {\r\n        return [...prev, { ...game, quantity: 1 }];\r\n      }\r\n    });\r\n  };\r\n\r\n  const removeFromCart = (id) => {\r\n    setCart(prev => prev.filter(game => game._id !== id));\r\n  };\r\n\r\n  const clearCart = () => setCart([]);\r\n\r\n  return (\r\n    <CartContext.Provider value={{ cart, addToCart, removeFromCart, clearCart }}>\r\n      {children}\r\n    </CartContext.Provider>\r\n  );\r\n};\r\n\r\nexport const useCart = () => useContext(CartContext);\r\n\r\n\r\n\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}